<!--how-to-cr-->

[工程实践-谷歌的工程实践文档](https://google.github.io/eng-practices/review/reviewer/)

<!--more-->

整理自：[【译】Google 官方文章——如何去做code review](https://juejin.im/post/5d80c27cf265da03e61b45c7)

## 术语

- CR: code review
- CL: change list，指这次改动
- NIT: nitpick，意思是鸡蛋里挑骨头
- LGTM: Looks good to me，没有问题

## CR 的标准

- 作为 reivew 的代码的 owner，reviewer 有责任保证 CR 的质量
- reviewer 不应追求完美，而应追求持续改进
- CR 具有指导意义
- 代码风格应该与现有的一致，如果项目没有统一风格，那就接受作者的风格
- 解决冲突难以达成共识时，需要面对面或者拉起更大的团队讨论，带上leader

## CR 中要看些什么

- CL 的总体设计
- 功能验证，功能性对于使用者们是好的，对于任何 UI 改动要合理且好看
- 是不是很复杂，有没有过度设计
- 代码有适当的单元测试
- 测试经过完善的设计
- 规范命名，看见名字就知道是什么
- 合适的注释，注释应该是 why 而不是 what
- 代码风格遵循 style guide，如果需要改代码风格应该在另一个 CL 解决
- CL 更改了构建、测试、交互、发布的时候，也要更新文档
- 仔细 review 每一行代码(除了资源文件、生成的代码、大型数据结构)
- 安全性、并发性、可访问性、国际化等复杂问题时需要更合适的人来 review
- 以整个系统的角度出发来思考 CL
- review 的时候，与其告诉开发者做错什么，还不如告诉他们做对了什么

## 如何浏览 CL

- 用宏观的角度来看待改动，查看 CL 描述以及它做什么
- 检查 CL 主要的部分
- 用合理的顺序看 CL 其余的改动

## review 的速度

- review 速度慢会导致团队整体的速度下降、开发人员开始抗议 CR、代码质量会受到影响
- 如果你处于需要专注工作的时候(比方说写代码)，不要打断自己去做 CR
- 个人回应评论的速度，比起让整个 CR 过程快速结束来得更为重要
- 在面对时区不同的问题时，尽量在他们还在办公室时回复作者
- 为加快速度，在某些情况下 reviewer 可以给予 LGTM 或 Approval，即便 CL 上仍有未解决的评论
- 由于改动过大导致难以 review 时，通常该做的是要求开发人员将 CL 拆解成多个较小的 CL
- CR 的速度应该要越来越快，但不要为提高想象中的速度，而对 CR 标准和代码质量做出妥协

## 如何写review评论

- 当开发人员不同意你的建议时，思考一下谁是正确的，并解释清楚，保持礼貌。
- 如果 review 坚持己见，会让开发者沮丧。沮丧很多时候是对于 CR 评论的写作方式有关，并非来自 reviewer 对于代码质量的坚持
- 如果 CL 引入了新的问题的话，除非是紧急情况，否则必须在提交之前将其处理掉
- 如果现在无法解决 review 的评论的问题的话，TODO 的注释并链接到刚记录下的缺陷

## review 太严格

提高 review 的速度会让这些抱怨逐渐消失。这些抱怨可能需要数个月才消失，但最终开发人员会看到严格的 review 所带来的价值，因为严格的 review 帮助他们产生的优秀代码